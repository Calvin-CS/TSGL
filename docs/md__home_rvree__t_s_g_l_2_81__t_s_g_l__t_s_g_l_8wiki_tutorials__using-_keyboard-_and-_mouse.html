<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TSGL: Using-Keyboard-And-Mouse</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">TSGL
   </div>
   <div id="projectbrief">A thread-safe graphics library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using-Keyboard-And-Mouse </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Let's get down to the "key" points here.</p>
<p>You can add I/O interaction to any animation that you draw on a Canvas/CartesianCanvas. That includes keyboard and mouse events only.</p>
<p>You may be asking us, "Is that done using magic??”</p>
<p>Well, TSGL makes it fairly easy.</p>
<p><em><b>Linux/Mac users:</b></em> Follow the steps from the previous tutorials. Name the folder "Tutorial7" and the file "interaction.cpp". Replace "program" in the "TARGET" line of the Makefile with "interaction".</p>
<p><em><b>Windows users:</b></em> Follow the steps from the previous tutorials. Name the Solution folder "Tutorial7" and the Visual Studio project "Interactive". After adding the Property sheet, name the .cpp file "interaction.cpp". Let's begin by creating and initializing a Canvas object:</p>
<p><em><b>All three platforms:</b></em> Follow the steps in the [[Building Programs]] page on how to compile and run the program (Linux/Mac users, this is a single-file program).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;tsgl.h&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>tsgl;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <a class="code" href="classtsgl_1_1_canvas.html">Canvas</a> c(0, 0, 500, 500, <span class="stringliteral">&quot;I/O Example&quot;</span>);</div>
<div class="line">  c.start();</div>
<div class="line">  c.wait();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Compile and run. A blank screen should appear.</p>
<p>Now, if you've taken a look at the <a href="http://calvin-cs.github.io/TSGL/html/index.html">TSGL API documentation</a> for Canvas, you may have seen that it has two methods: <a href="http://calvin-cs.github.io/TSGL/html/classtsgl_1_1_canvas.html#a26f2f1acf2b80eee95e42bc13dbc7600">bindToButton()</a> and <a href="http://calvin-cs.github.io/TSGL/html/classtsgl_1_1_canvas.html#aecd3d94790d2e660db380a5e951ae394">bindToScroll()</a>.</p>
<p>These two methods are where the I/O magic happens.</p>
<p>They allow us to bind keys, mouse buttons, and the mouse scroll wheel to a Canvas which will allow us to have I/O capabilities in our animations.</p>
<p>But how do these methods work?</p>
<p>Well, before we answer that, allow us to explain a crucial aspect of these methods: Lambda functions.</p>
<p>Taken from <a href="http://en.cppreference.com/w/cpp/language/lambda,">http://en.cppreference.com/w/cpp/language/lambda,</a> a Lambda function: "Constructs a closure: an unnamed function object capable of capturing variables in scope."</p>
<p>What does that mean?</p>
<p>It is essentially an unnamed function that can access any variables that are in scope, and that can be passed as an argument to another function.</p>
<p>"Okay, great" you may be thinking "but how does this relate to the methods?"</p>
<p>In order to handle mouse and/or keyboard I/O, the <code>bindToButton()</code> and <code>bindToScroll()</code> methods each take a Lambda function as an argument. In the <code>bindToButton()</code> method, the Lambda function is associated with a keyboard key or mouse button and an action, which are also passed as arguments. In the <code>bindToScroll()</code> method, the Lambda function is the only argument.</p>
<p>Let's look at an example to make it clear:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;tsgl.h&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>tsgl;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <a class="code" href="classtsgl_1_1_canvas.html">Canvas</a> c(0, 0, 500, 500, <span class="stringliteral">&quot;I/O Example&quot;</span>);</div>
<div class="line">  c.start();</div>
<div class="line">  c.setBackgroundColor(WHITE);</div>
<div class="line">  <span class="comment">//This variable is in the scope of the Lambda function.</span></div>
<div class="line">  <span class="comment">//It can be passed in.</span></div>
<div class="line">  <span class="keywordtype">bool</span> leftMouseButtonPressed = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Bind the left mouse button so that when it&#39;s pressed</span></div>
<div class="line">  <span class="comment">//the boolean is set to true.</span></div>
<div class="line">  c.bindToButton(TSGL_MOUSE_LEFT, TSGL_PRESS,</div>
<div class="line">                    [&amp;leftMouseButtonPressed]() {</div>
<div class="line">                          leftMouseButtonPressed = <span class="keyword">true</span>;</div>
<div class="line">                    }</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Bind the left mouse button again so that when it&#39;s released</span></div>
<div class="line">  <span class="comment">//the boolean is set to false.</span></div>
<div class="line">  c.bindToButton(TSGL_MOUSE_LEFT, TSGL_RELEASE,</div>
<div class="line">                    [&amp;leftMouseButtonPressed]() {</div>
<div class="line">                          leftMouseButtonPressed = <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Drawing loop</span></div>
<div class="line">  <a class="code" href="classtsgl_1_1_rectangle.html">Rectangle</a> rec(25, 250, 40, 30, RED);</div>
<div class="line">  c.add( &amp;rec );</div>
<div class="line">  <span class="keywordflow">while</span>(c.isOpen()) {</div>
<div class="line">    c.sleep();</div>
<div class="line">    <span class="keywordflow">if</span>(leftMouseButtonPressed) {</div>
<div class="line">      rec.setColor(GREEN);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      rec.setColor(RED);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  c.wait();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Recompile and run. A rectangle should appear in red on the screen. Click the screen with the left mouse button. The color of the rectangle should change to green.</p>
<p>The <code>bindToButton()</code> method takes in three parameters:</p><ul>
<li>A key or button to bind to (e.g. <code>TSGL_A</code> for the 'A' key).</li>
<li>An event associated with that key (<code>TSGL_PRESS</code> for when it's pressed, <code>TSGL_RELEASE</code> when it is released).</li>
<li>An unnamed (Lambda) function that will be passed to <code>bindToButton()</code> when that method is invoked.</li>
</ul>
<p>Allow us to explain Lambda functions in a little more depth.</p>
<p>Variables inside the brackets are variables defined outside of the function that are in its scope, and that are being passed into the function. The ampersand makes the variable a reference parameter. In a nutshell, that means that whatever you do to that parameter in the function will affect the variable being passed as the parameter. So, if we passed a boolean <code>switch</code> as the parameter and it has a value of <code>false</code> before the function runs and inside the function, we change the value of the parameter to <code>true</code>, then when the function finishes, the variable <code>switch</code> will have <code>true</code> as its value instead of <code>false</code>.</p>
<p>The variables <em>MUST</em> be passed as reference parameters.</p>
<p>Passing reference variables to the unnamed Lambda function is called "capturing" the parameters.</p>
<p>Now, in the definition of the Lambda function, you can alter the reference parameters so that whenever the Lambda function is invoked the reference parameters are changed to values you want to assign to them.</p>
<p>The mouse click and release event are bound to the Lambda functions that set a boolean variable to true and false (respectively).</p>
<p>"Bound" means that the corresponding Lambda function will be invoked once the action occurs:</p>
<ul>
<li>Once the mouse has been clicked, the Lambda function bound to the left mouse button click event will be invoked and the boolean <code>leftMouseButtonPressed</code> changes to true.</li>
<li>Once it has been released, the Lambda function bound to the left mouse button click event will be invoked and the boolean <code>leftMouseButtonPressed</code> changes to false.</li>
</ul>
<p>As you can see, whenever the left mouse button is clicked, the boolean variable <code>leftMouseButtonPressed</code> is set to true and when the left mouse button is released it is set to false.</p>
<p>Now, how do we get the Canvas to draw stuff once the mouse button is clicked?</p>
<p>In the animation loop shown below, if <code>leftMouseButtonPressed</code> has been set to <code>true</code> then we can have the Canvas draw a circle that is centered by the mouse's x and y-coordinates:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;tsgl.h&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>tsgl;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <a class="code" href="classtsgl_1_1_canvas.html">Canvas</a> c(0, 0, 500, 500, <span class="stringliteral">&quot;I/O Example&quot;</span>);</div>
<div class="line">  c.start();</div>
<div class="line">  c.setBackgroundColor(WHITE);</div>
<div class="line">  <span class="comment">//This variable is in the scope of the Lambda function.</span></div>
<div class="line">  <span class="comment">//It can be passed in.</span></div>
<div class="line">  <span class="keywordtype">bool</span> leftMouseButtonPressed = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Bind the left mouse button so that when it&#39;s pressed</span></div>
<div class="line">  <span class="comment">//the boolean is set to true.</span></div>
<div class="line">  c.bindToButton(TSGL_MOUSE_LEFT, TSGL_PRESS,</div>
<div class="line">                    [&amp;leftMouseButtonPressed]() {</div>
<div class="line">                          leftMouseButtonPressed = <span class="keyword">true</span>;</div>
<div class="line">                    }</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Bind the left mouse button again so that when it&#39;s released</span></div>
<div class="line">  <span class="comment">//the boolean is set to false.</span></div>
<div class="line">  c.bindToButton(TSGL_MOUSE_LEFT, TSGL_RELEASE,</div>
<div class="line">                    [&amp;leftMouseButtonPressed]() {</div>
<div class="line">                          leftMouseButtonPressed = <span class="keyword">false</span>;</div>
<div class="line">                    }</div>
<div class="line">                );</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Drawing loop</span></div>
<div class="line">  <a class="code" href="classtsgl_1_1_rectangle.html">Rectangle</a> rec(25, 250, 40, 30, RED);</div>
<div class="line">  <a class="code" href="classtsgl_1_1_circle.html">Circle</a> circle(0, 0, 20, BLACK);</div>
<div class="line">  c.add( &amp;rec ); c.add( &amp;circle );</div>
<div class="line">  <span class="keywordflow">while</span>(c.isOpen()) {</div>
<div class="line">    c.sleep();</div>
<div class="line">    <span class="keywordtype">int</span> x = c.getMouseX(), y = c.getMouseY();  <span class="comment">//Store the x and y-coordinates of the mouse</span></div>
<div class="line">    <span class="keywordflow">if</span>(leftMouseButtonPressed) {</div>
<div class="line">      rec.setColor(GREEN);</div>
<div class="line">      circle.setCenter(x, y);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      rec.setColor(RED);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  c.wait();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Recompile and run the code. Now, click on the left mouse button while the mouse is on the screen. The black, filled-in circle should appear below your mouse cursor!</p>
<p>You can even hold down the left mouse button and drag the mouse over the screen and the black circle will follow your mouse!</p>
<p>How about an example using the <code>bindToScroll()</code> method instead?</p>
<p>Let's take a look:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;tsgl.h&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span>tsgl;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">  <a class="code" href="classtsgl_1_1_canvas.html">Canvas</a> c(0, 0, 500, 500, <span class="stringliteral">&quot;I/O Example&quot;</span>);</div>
<div class="line">  c.start();</div>
<div class="line">  c.setBackgroundColor(WHITE);</div>
<div class="line">  <span class="comment">//These variables are in the scope of the Lambda function.</span></div>
<div class="line">  <span class="comment">//They can be passed in.</span></div>
<div class="line">  <span class="keywordtype">int</span> circleX = 250, circleY = 250;</div>
<div class="line"> </div>
<div class="line">  c.bindToScroll([&amp;circleY](<span class="keywordtype">double</span> dx, <span class="keywordtype">double</span> dy) {</div>
<div class="line">    <span class="keywordflow">if</span>(dy == 1.0) { <span class="comment">//If you move the scroll wheel down...</span></div>
<div class="line">      circleY -= 50;  <span class="comment">//Decrement the circle&#39;s y-coordinate.</span></div>
<div class="line">    } <span class="keywordflow">else</span> { <span class="comment">//Else...</span></div>
<div class="line">      circleY += 50;  <span class="comment">//Increment the coordinate.</span></div>
<div class="line">    }</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Drawing loop</span></div>
<div class="line">  <a class="code" href="classtsgl_1_1_circle.html">Circle</a> circle(circleX, circleY, 50);</div>
<div class="line">  c.add( &amp;circle );</div>
<div class="line">  <span class="keywordflow">while</span>(c.isOpen()) {</div>
<div class="line">    c.sleep();</div>
<div class="line">    circle.setCenter(circleX, circleY);</div>
<div class="line">  }</div>
<div class="line">  c.wait();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Recompile and run. A black circle should appear on the screen. Scroll up to make the circle go up, scroll down to make the circle go down.</p>
<p>Allow us to explain this example.</p>
<p>The bindToScroll() method takes in a Lambda function, which in turn, takes in two parameters:</p>
<ul>
<li>dx, which is an x parameter whose value is set when the mouse is scrolled.</li>
<li>dy, which is a y parameter whose value is set when the mouse is scrolled.</li>
</ul>
<p>The parameters dx and dy contain the x and y coordinates of the mouse when the event occurs — when the method is invoked — and can be used to access those coordinates within the body of the method.</p>
<p>The <code>bindToScroll()</code> method MUST take in those two parameters, even if one or both parameters are not used.</p>
<p>In sum, in order to do animations with I/O capabilities, you need to use <code>bindToButton()</code> for keyboard and mouse button events and <code>bindToScroll()</code> for mouse scroll wheel events.</p>
<p>See <a href="http://calvin-cs.github.io/TSGL/html/_keynums_8h_source.html">Keynums.h</a> for constants that are mapped to specific keys on the keyboard as well as are mapped to the mouse buttons and scroll wheel.</p>
<p>The CartesianCanvas handles I/O in exactly the same way as the standard Canvas does (since it is a subclass of the Canvas class).</p>
<p>That completes this tutorial!</p>
<p>Next up, in [[Command-line arguments]], we take a look at using command-line arguments in our animations. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aclasstsgl_1_1_circle_html"><div class="ttname"><a href="classtsgl_1_1_circle.html">tsgl::Circle</a></div><div class="ttdoc">Draw a circle.</div><div class="ttdef"><b>Definition:</b> Circle.h:16</div></div>
<div class="ttc" id="aclasstsgl_1_1_canvas_html"><div class="ttname"><a href="classtsgl_1_1_canvas.html">tsgl::Canvas</a></div><div class="ttdoc">A GL window with numerous built-in, thread-safe drawing operations.</div><div class="ttdef"><b>Definition:</b> Canvas.h:88</div></div>
<div class="ttc" id="aclasstsgl_1_1_rectangle_html"><div class="ttname"><a href="classtsgl_1_1_rectangle.html">tsgl::Rectangle</a></div><div class="ttdoc">Draw a simple Rectangle.</div><div class="ttdef"><b>Definition:</b> Rectangle.h:16</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 26 2021 14:41:19 for TSGL by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
